# ipv6
开启内核参数
sysctl -w net.ipv6.conf.all.forwarding=1

# IPv6 地址段解释

IPv6 一共128位（bits），分8个段，每个段有16位。用16进制表示，一个16进制可以代表4个位，因此每个段有4个16进制数，即FFFF:FFFF:FFFF:FFFF:FFFF:FFFF:FFFF:FFFF

## ”公网ip“ - 可聚合全局单播地址 Aggregatable Global Unicast Address

前缀以固定001开头。即2xxx::/3 或者3xxx::/3

## ”私有ip" -  唯一本地地址 Unique Local Address

固定前缀FC00::/7，即前7位固定为1111 110。 第8位如果设置了，代表了本地地址。即实际分成2个ip块。 FC00::/8 以及FD00::/8。

FC00::/8 目前没有被使用（`not defined` from wikipedia）

实际有用的ip块为 FD00::/8


## 链路本地地址(Link-local address)

前缀为FE80::/10，11-64位全为0，最后64位为接口标识（或者称为接口id，一般为EUI-64）。一般是将48位的mac地址按一定算法转换成64位的接口id，该id具有本地链路唯一性。

用于自动地址配置、邻居发现、路由器发现等机制中。

### EUI-64算法

将 48位的mac地址，拆成24位与24位，在这中间插入FFFE一共16位，组成64位。由于mac地址的第7位，1代表本地管理，0代表全球管理。而EUI-64定义刚好相反，1为全球管理，0位本地。因此最后还需要将第7位取反，得到最终的EUI-64。


## 组播地址与请求节点组播地址与组播的mac地址

ipv4使用广播方式查找mac地址，ipv6弃用广播方式，采用单播，组播（即分组形式）等方式，减少消耗，提高性能。

组播地址，固定前缀为FFxx::/8，即前8位固定为1。内置的各种组播地址参考底下链接组播相关内容的图片。

请求节点组播地址，基于ip生成，固定前缀FF02::1:FF00:0/104，后面24位由v6 ip的后24位填充。这样可以定向的给这个节点发送数据。

组播的mac地址，前80位由组播地址前80位组成，81-96位固定为3333（16进制表示），后32位，由组播地址的后32位补充

具体可参考： <https://blog.51cto.com/u_7658423/1337745>


## 其他
IPv6 可以不需要通过dhcp获取ip地址，还可以使用无状态地址配置的方式，通过交换机返回的信息，结合本机生成IPv6地址

## 参考资料

<https://zhuanlan.zhihu.com/p/425805018>
<https://zhuanlan.zhihu.com/p/382612295>

